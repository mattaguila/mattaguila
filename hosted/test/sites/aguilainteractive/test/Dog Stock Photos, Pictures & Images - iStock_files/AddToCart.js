
namespacing={init:function(namespace){var spaces=[];namespace.split('.').each(function(space){var curSpace=window,i;spaces.push(space);for(i=0;i<spaces.length;i++){if(typeof curSpace[spaces[i]]==='undefined'){curSpace[spaces[i]]={};}
curSpace=curSpace[spaces[i]];}});}};var $j=jQuery.noConflict();$j(document).ready(function(){$j(this).addToCart();});(function($){$.fn.addToCart=function(){var fileHandler={init:function(){$(document).on('click','.cartAdd',function(){fileHandler.upsertFileToCart($(this).attr('id'));});},upsertFileToCart:function(fileId){var searchToken=istock.search.resultsHandler.getSearchToken();var ajaxUrl='/cart-ajax/upsert-file/fileId/'+fileId+'/asNewest/1'+'/searchToken/'+searchToken;$j.ajax(ajaxUrl).done(function(response){var status=response.status;var settings={content:response.viewscript}
if(status==='insert'||status==='update'){settings.title='<h3>'+response.title+'</h3>';$('#filesCount').text(response.filesCount);$('#toolbar-cart').addClass('active');}else if(status==='failure'){settings.title='<h3 class="err">'+response.title+'</h3>';if(response.cause==='cartFull'){$('#toolbar-cart span').addClass('err');$('#toolbar-cart').removeClass('active');}}
$('#toolbar-cart span').addClass('files-count-bold');$('#cart-toaster').toaster(settings);if(response.status!='failure'){document.fire('omniture:SearchAddToCart',{'productString':response.omniture});}});},};fileHandler.init();};})(jQuery);