
namespacing={init:function(namespace){var spaces=[];namespace.split('.').each(function(space){var curSpace=window,i;spaces.push(space);for(i=0;i<spaces.length;i++){if(typeof curSpace[spaces[i]]==='undefined'){curSpace[spaces[i]]={};}
curSpace=curSpace[spaces[i]];}});}};lb={cash_sales_init:function(fileId,concreteTypeId,licenses){this.fileId=fileId;this.concreteTypeId=concreteTypeId;for(var index in licenses){licenses[index]='el%5B%5D='+licenses[index];}
this.license='el&'+licenses.join('&');lb.download_init();},download_init:function(){var url="ajax_class_creator.php";var params="ajax_action=GetDialog&ajax_class=filecloseup&Lightbox=0&FileID="+this.fileId+"&ConcreteTypeID="+this.concreteTypeId+"&license="+this.license;var myAjax=new Ajax.Request(url,{asynchronous:true,method:"get",parameters:params,onSuccess:lb.showDialog.bind(this),on301:lb.xhrError.bind(this),on400:lb.xhrError.bind(this),on401:lb.xhrError.bind(this),on403:lb.xhrError.bind(this),on404:lb.xhrError.bind(this),on500:lb.xhrError.bind(this),on503:lb.xhrError.bind(this),on504:lb.xhrError.bind(this),onFailure:lb.xhrError.bind(this)});},showDialog:function(xhrReq){if(xhrReq.status==0){alert('XHR Error Code '+xhrReq.status+' - Please refresh your page and try again.');}else{var json=xhrReq.responseText.evalJSON(true);if($('dnldSpinner_'+this.formID))$('dnldSpinner_'+this.formID).hide();$j('#buy-button-loader').hide();$j('#buy-button-credit').show();ajaxWin.show(json);}},license_init:function(cllctn){collection=(cllctn=='sub')?'Subscription':'PayAsYouGo';this.collection=collection;var url="ajax_class_creator.php";var params="ajax_action=GetDialog&ajax_class=filecloseup&Collection="+collection+"&FileID="+this.fileId+"&ConcreteTypeID="+this.concreteTypeId+"&license="+this.license;var myAjax=new Ajax.Request(url,{asynchronous:true,method:"get",parameters:params,onSuccess:lb.showDialog.bind(this),on301:lb.xhrError.bind(this),on400:lb.xhrError.bind(this),on401:lb.xhrError.bind(this),on403:lb.xhrError.bind(this),on404:lb.xhrError.bind(this),on500:lb.xhrError.bind(this),on503:lb.xhrError.bind(this),on504:lb.xhrError.bind(this),onFailure:lb.xhrError.bind(this)});},file_init:function(collection,isLightbox){var url="ajax_class_creator.php";var params="ajax_action=DownloadStarted&ajax_class=filecloseup&InitDL=Y&Collection="+collection+"&Lightbox="+isLightbox+"&FileID="+this.fileId+"&ConcreteTypeID="+this.concreteTypeId+"&license="+this.license;var myAjax=new Ajax.Request(url,{asynchronous:true,method:"post",parameters:params,onSuccess:lb.file_init_success.bind(this),on301:lb.xhrError.bind(this),on400:lb.xhrError.bind(this),on401:lb.xhrError.bind(this),on403:lb.xhrError.bind(this),on404:lb.xhrError.bind(this),on500:lb.xhrError.bind(this),on503:lb.xhrError.bind(this),on504:lb.xhrError.bind(this),onFailure:lb.xhrError.bind(this)});},file_init_success:function(xhrReq){var json=xhrReq.responseText.evalJSON(true);ajaxWin.show(json);document.fire('omniture:trackLegacyDownload',json['omniture']);document.fire('tracking:trackDownload',json['tracking']);if(!Prototype.Browser.IE){lb.track_download(json.trackLink);document.body.insert('<iframe src="'+json.link+'" style="display: none;"></iframe>');lb.show_download_links.delay(5);}else{lb.show_download_links();}},show_download_links:function(){$('purchase_download_links').show();$('purchase_download_spinner').hide();},track_download:function(trackLink){try{if(istock.trackdownloads&&trackLink){document.body.insert('<iframe src="'+trackLink+'" style="display: none;"></iframe>');}}catch(e){}},xhrError:function(xhrReq){var mssg='XHR Error - Code '+xhrReq.status+' ';switch(xhrReq.status){case 301:mssg+='Content Moved';break;case 400:mssg+='Bad Request';break;case 401:mssg+='Unauthorized';break;case 403:mssg+='Forbidden';break;case 404:mssg+='Not Found';break;case 500:mssg+='Internal Server Error';break;case 503:mssg+='Service Unavailable';break;case 504:mssg+='Gateway Timeout';break;case 505:mssg+='HTTP Version Not Supported';break;}
mssg+="\n\nPlease clear your browser's cache,\nreload the page and try your request again."
alert(mssg);}}
Event.observe(window, 'load', function() {$$('.fullPage .widget_select').each(function(elm){new Autocompleter.SelectBox(elm,{width:350,callback:'lb.calcSelectPrice'});});});try{document.fire('ajax_lightboxdownload:loaded');}catch(e){}